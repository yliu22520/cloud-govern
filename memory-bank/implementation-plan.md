# 实施计划 - Cloud Govern

> 版本: 1.0 | 创建日期: 2026-02-13

---

## 📋 计划概览

### 阶段划分

```
Phase 0: 环境准备 ──────────────────────────────────> 预计 1 天
    │
    ▼
Phase 1: 基础架构 ──────────────────────────────────> 预计 2-3 天
    │
    ▼
Phase 2: 用户管理模块 ──────────────────────────────> 预计 2-3 天
    │
    ▼
Phase 3: 服务注册管理模块 ──────────────────────────> 预计 2-3 天
    │
    ▼
Phase 4: 配置中心管理模块 ──────────────────────────> 预计 2-3 天
    │
    ▼
Phase 5: 服务监控模块 ──────────────────────────────> 预计 2-3 天
    │
    ▼
Phase 6: API 网关管理模块 ──────────────────────────> 预计 2-3 天
    │
    ▼
Phase 7: 集成测试与优化 ────────────────────────────> 预计 2-3 天
```

### 总体时间估算
- **MVP 完成时间**: 2-3 周
- **每日投入**: 2-4 小时

---

## Phase 0: 环境准备

### 目标
搭建开发环境，确保所有基础设施组件正常运行。

### 步骤

#### Step 0.1: 创建项目仓库
- [ ] 在 GitHub 创建仓库 `cloud-govern`
- [ ] 克隆到本地
- [ ] 初始化目录结构

**验证标准**:
- 目录结构符合规范
- Git 提交成功

#### Step 0.2: 启动基础设施
- [ ] 安装 Docker Desktop
- [ ] 创建 `docker-compose.yml` 启动 Nacos、MySQL、Redis
- [ ] 验证各服务正常运行

**验证标准**:
```bash
# 检查服务状态
curl http://localhost:8848/nacos/v1/console/health/readiness
# 预期返回：{"status":"UP"}

# 检查 MySQL
mysql -h127.0.0.1 -uroot -p -e "SELECT 1"

# 检查 Redis
redis-cli ping
# 预期返回：PONG
```

#### Step 0.3: 初始化数据库
- [ ] 创建数据库 `cloud_govern`
- [ ] 执行初始化 SQL 脚本

**验证标准**:
- 数据库表创建成功
- 初始数据插入成功

---

## Phase 1: 基础架构

### 目标
搭建后端微服务基础架构和前端项目骨架。

### 步骤

#### Step 1.1: 创建后端父工程
- [ ] 创建 Maven 父工程 `cloud-govern`
- [ ] 配置 `pom.xml` 依赖管理
- [ ] 创建公共模块 `cloud-govern-common`

**验证标准**:
- Maven 构建成功：`mvn clean install`
- 公共模块可被其他模块依赖

#### Step 1.2: 创建网关服务
- [ ] 创建模块 `cloud-govern-gateway`
- [ ] 配置 Spring Cloud Gateway
- [ ] 配置 Nacos 服务注册
- [ ] 实现全局过滤器（跨域、日志）

**验证标准**:
- 启动网关服务
- 在 Nacos 控制台看到服务注册
- 访问 `http://localhost:8080/actuator/health` 返回健康状态

#### Step 1.3: 创建认证服务
- [ ] 创建模块 `cloud-govern-auth`
- [ ] 集成 Sa-Token
- [ ] 实现登录接口
- [ ] 实现 Token 验证

**验证标准**:
```bash
# 登录测试
curl -X POST http://localhost:8080/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'
# 预期返回：包含 token 的 JSON
```

#### Step 1.4: 创建前端项目
- [ ] 使用 Vite 创建 Vue 3 项目
- [ ] 安装 TDesign、Pinia、Vue Router、Axios
- [ ] 配置项目结构
- [ ] 配置 ESLint、Prettier

**验证标准**:
- 运行 `npm run dev` 成功
- 访问 `http://localhost:5173` 显示页面
- ESLint 检查通过：`npm run lint`

#### Step 1.5: 前后端联调测试
- [ ] 前端配置代理到网关
- [ ] 实现登录页面
- [ ] 实现登录流程（调用后端接口 → 存储 Token → 跳转首页）

**验证标准**:
- 前端登录成功
- Token 正确存储在 localStorage
- 页面正确跳转

---

## Phase 2: 用户管理模块

### 目标
实现用户、角色、菜单的完整 CRUD 和权限控制。

### 步骤

#### Step 2.1: 创建系统服务
- [ ] 创建模块 `cloud-govern-system`
- [ ] 配置数据库连接
- [ ] 使用 MyBatis-Plus 代码生成器生成基础代码

**验证标准**:
- 服务启动成功
- 注册到 Nacos

#### Step 2.2: 用户管理 API
- [ ] 创建用户实体、DTO、VO
- [ ] 实现用户 CRUD 接口
- [ ] 实现密码加密
- [ ] 实现用户状态管理

**API 列表**:
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /system/user/list | 用户列表（分页） |
| GET | /system/user/{id} | 用户详情 |
| POST | /system/user | 创建用户 |
| PUT | /system/user/{id} | 更新用户 |
| DELETE | /system/user/{id} | 删除用户 |

**验证标准**:
- Postman/Apifox 测试所有接口通过
- 数据库数据正确

#### Step 2.3: 角色管理 API
- [ ] 创建角色实体
- [ ] 实现角色 CRUD 接口
- [ ] 实现角色-菜单关联

**验证标准**:
- 角色增删改查正常
- 角色-菜单关联正确

#### Step 2.4: 菜单管理 API
- [ ] 创建菜单实体（支持树形结构）
- [ ] 实现菜单 CRUD 接口
- [ ] 实现菜单排序

**验证标准**:
- 菜单树形结构正确
- 菜单排序生效

#### Step 2.5: 前端用户管理页面
- [ ] 创建用户列表页面（表格、搜索、分页）
- [ ] 创建用户表单（新增/编辑）
- [ ] 实现用户删除确认
- [ ] 创建角色管理页面
- [ ] 创建菜单管理页面（树形表格）

**验证标准**:
- 所有页面功能正常
- 权限控制生效

---

## Phase 3: 服务注册管理模块

### 目标
实现对 Nacos 服务注册中心的管理功能。

### 步骤

#### Step 3.1: 创建服务注册模块
- [ ] 创建模块 `cloud-govern-registry`
- [ ] 封装 Nacos Open API 客户端

**验证标准**:
- Nacos API 调用正常

#### Step 3.2: 服务列表 API
- [ ] 实现服务列表查询
- [ ] 实现服务详情查询
- [ ] 实现服务健康状态查询

**API 列表**:
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /registry/service/list | 服务列表 |
| GET | /registry/service/{serviceName} | 服务详情 |
| GET | /registry/service/{serviceName}/instances | 实例列表 |

**验证标准**:
- 能查询到 Nacos 注册的所有服务
- 显示服务健康状态

#### Step 3.3: 实例管理 API
- [ ] 实现实例上线/下线
- [ ] 实现实例权重修改
- [ ] 实现实例元数据修改

**验证标准**:
- 实例操作生效
- Nacos 控制台同步显示

#### Step 3.4: 前端服务管理页面
- [ ] 创建服务列表页面
- [ ] 创建服务详情页面
- [ ] 创建实例管理组件

**验证标准**:
- 页面展示正确
- 操作功能正常

---

## Phase 4: 配置中心管理模块

### 目标
实现对 Nacos 配置中心的管理功能。

### 步骤

#### Step 4.1: 创建配置中心模块
- [ ] 创建模块 `cloud-govern-config`
- [ ] 封装 Nacos Config API 客户端

#### Step 4.2: 命名空间管理 API
- [ ] 实现命名空间 CRUD
- [ ] 实现命名空间切换

**验证标准**:
- 命名空间管理功能正常

#### Step 4.3: 配置管理 API
- [ ] 实现配置列表查询
- [ ] 实现配置详情查询
- [ ] 实现配置创建/更新
- [ ] 实现配置删除
- [ ] 实现配置历史查询
- [ ] 实现配置回滚

**API 列表**:
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /config/config/list | 配置列表 |
| GET | /config/config/{id} | 配置详情 |
| POST | /config/config | 创建配置 |
| PUT | /config/config | 更新配置 |
| DELETE | /config/config | 删除配置 |
| GET | /config/config/history | 配置历史 |
| POST | /config/config/rollback | 配置回滚 |

**验证标准**:
- 配置 CRUD 正常
- 历史版本查询正常
- 回滚功能正常

#### Step 4.4: 前端配置管理页面
- [ ] 创建命名空间选择组件
- [ ] 创建配置列表页面
- [ ] 创建配置编辑页面（Monaco Editor）
- [ ] 创建配置历史弹窗

**验证标准**:
- 配置编辑器语法高亮
- 配置保存成功
- 历史对比功能正常

---

## Phase 5: 服务监控模块

### 目标
实现服务健康监控和基础告警功能。

### 步骤

#### Step 5.1: 创建监控模块
- [ ] 创建模块 `cloud-govern-monitor`
- [ ] 集成 Spring Boot Actuator
- [ ] 实现指标采集

#### Step 5.2: 服务健康检查
- [ ] 实现定时健康检查
- [ ] 记录服务状态历史
- [ ] 实现状态变更通知

**验证标准**:
- 服务下线后能及时检测
- 状态变更能触发通知

#### Step 5.3: 监控仪表盘 API
- [ ] 实现服务状态汇总
- [ ] 实现指标数据查询
- [ ] 实现告警规则管理

#### Step 5.4: 前端监控页面
- [ ] 创建监控仪表盘
- [ ] 创建服务状态卡片
- [ ] 创建指标图表（ECharts）
- [ ] 创建告警规则配置页面

**验证标准**:
- 仪表盘数据正确
- 图表展示正常

---

## Phase 6: API 网关管理模块

### 目标
实现对 Spring Cloud Gateway 路由规则的管理。

### 步骤

#### Step 6.1: 创建网关管理模块
- [ ] 创建模块 `cloud-govern-gateway-admin`
- [ ] 设计路由规则数据模型

#### Step 6.2: 路由管理 API
- [ ] 实现路由规则 CRUD
- [ ] 实现路由规则动态刷新
- [ ] 实现路由规则验证

**API 列表**:
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /gateway/route/list | 路由列表 |
| GET | /gateway/route/{id} | 路由详情 |
| POST | /gateway/route | 创建路由 |
| PUT | /gateway/route/{id} | 更新路由 |
| DELETE | /gateway/route/{id} | 删除路由 |
| POST | /gateway/route/refresh | 刷新路由 |

**验证标准**:
- 路由规则 CRUD 正常
- 动态刷新生效

#### Step 6.3: 限流规则管理
- [ ] 集成 Sentinel
- [ ] 实现限流规则管理
- [ ] 实现熔断规则管理

**验证标准**:
- 限流规则生效
- 熔断规则生效

#### Step 6.4: 前端网关管理页面
- [ ] 创建路由规则列表页面
- [ ] 创建路由规则表单
- [ ] 创建限流规则配置页面

**验证标准**:
- 路由管理功能正常
- 限流配置生效

---

## Phase 7: 集成测试与优化

### 目标
完成系统集成测试，优化性能和用户体验。

### 步骤

#### Step 7.1: 集成测试
- [ ] 编写接口测试用例
- [ ] 执行全量测试
- [ ] 修复发现的 Bug

**验证标准**:
- 测试覆盖率 > 70%
- 所有测试用例通过

#### Step 7.2: 性能优化
- [ ] 数据库查询优化
- [ ] 接口响应缓存
- [ ] 前端打包优化

**验证标准**:
- 首页加载时间 < 3s
- 接口响应时间 < 500ms

#### Step 7.3: 文档完善
- [ ] 编写 README.md
- [ ] 编写部署文档
- [ ] 编写 API 文档

**验证标准**:
- 文档完整清晰
- 新人可按文档部署

#### Step 7.4: Docker 化
- [ ] 编写 Dockerfile
- [ ] 编写 docker-compose.yml
- [ ] 测试一键部署

**验证标准**:
- `docker-compose up -d` 一键启动
- 所有服务正常运行

---

## 📊 进度跟踪

使用 `progress.md` 文件记录每个步骤的完成情况。

---

## ⚠️ 注意事项

1. **每完成一步，必须验证后再进入下一步**
2. **遇到问题及时记录，不要跳过**
3. **定期提交代码，保持小步快跑**
4. **代码质量优先于进度**

---

**文档维护者**: AI Assistant
**最后更新**: 2026-02-13
